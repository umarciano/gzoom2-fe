<h3 class="first">{{'GP_MENU_00334'|i18n}}</h3>

<p-growl [life]=10000 [sticky]="false" [value]="msgs"></p-growl>

<p-dataTable [value]="timesheets"
            sortMode="multiple"
            resizableColumns="true"
            [responsive]="true"
            #dt exportFilename="timesheets">
    <p-header>
      <div class="ui-helper-clearfix">
        <button type="button" pButton icon="fa-file-o" iconPos="left" label="{{'CSV'|i18n}}" (click)="dt.exportCSV()" style="float:left"></button>
      </div>
    </p-header>
    <p-column [style]="{'width':'20%'}" field="partyId" header="{{'Party Id'}}" [sortable]="true"></p-column>
    <p-column [style]="{'width':'20%'}" field="timesheetId" header="{{'Timesheet Id'}}" [sortable]="true"></p-column>
    <p-column [style]="{'width':'20%'}" field="fromDate" header="{{'From Date'|i18n}}" [sortable]="true"></p-column>
    <p-column [style]="{'width':'20%'}" field="thruDate" header="{{'Thru Date'|i18n}}" [sortable]="true"></p-column>
    <p-column [style]="{'width':'20%'}" field="contractHours" header="{{'Contract Hours'|i18n}}" [sortable]="true"></p-column>
    <p-column [style]="{'width':'20%'}" field="actualHours" header="{{'Actual Hours'|i18n}}" [sortable]="true"></p-column>
    <p-column [style]="{'width':'10%'}" styleClass="col-button">
        <ng-template pTemplate="header">
            <button type="button" pButton icon="fa-plus" (click)="showDialogToAdd()"></button>
        </ng-template>
        <ng-template let-uomType="rowData" pTemplate="body">
            <button type="button" pButton icon="fa-pencil" (click)="selectTimesheet(timesheet)"></button>
        </ng-template>
    </p-column>
</p-dataTable>

<p-dialog header="{{'Timesheet Detail'|i18n}}" width="900" [(visible)]="displayDialog" [responsive]="true" showEffect="fade" [modal]="true">
  <form [formGroup]="form" novalidate (ngSubmit)="save()">
    <div class="ui-grid ui-grid-responsive ui-fluid" *ngIf="timesheet">

      <!-- TODO timesheetId deve essere incrementale-->
      <div class="ui-grid-row">
        <div class="ui-grid-col-3">
          <label for="timeshhetId">{{'Timesheet id'|i18n}}*:</label>
        </div>
        <div class="ui-grid-col-4">
          <input pInputText class="form-control" formControlName="timesheetId" required [(ngModel)]="timesheet.timesheetId" maxlength="20"/>
        </div>
        <div class="ui-grid-col-5">
          <div class="ui-message ui-messages-error ui-corner-all" *ngIf="!form.controls['timesheetId'].valid&amp;&amp;form.controls['timesheetId'].dirty">
            <i class="fa fa-close"></i>
            <span *ngIf="form.controls['timesheetId'].errors['required']">{{'Uom Type Id is required'|i18n}}</span>
          </div>
        </div>
      </div>
      <!-- TODO partyId deve essere fk della tabella party. Dropdown di selezione? -->
      <div class="ui-grid-row">
        <div class="ui-grid-col-3">
          <label for="partyId">{{'Party id'|i18n}}*:</label>
        </div>
        <div class="ui-grid-col-4">
          <input pInputText class="form-control" formControlName="partyId" required [(ngModel)]="timesheet.partyId" maxlength="20"/>
        </div>
        <div class="ui-grid-col-5">
          <div class="ui-message ui-messages-error ui-corner-all" *ngIf="!form.controls['partyId'].valid&amp;&amp;form.controls['partyId'].dirty">
            <i class="fa fa-close"></i>
            <span *ngIf="form.controls['partyId'].errors['required']">{{'Party Id is required'|i18n}}</span>
          </div>
        </div>
      </div>
      <div class="ui-grid-row">
        <div class="ui-grid-col-3">
          <label for="fromDate">{{'From Date'|i18n}}:</label>
        </div>
        <div class="ui-grid-col-4">
          <p-calendar formControlName="fromDate" [showIcon]="true"></p-calendar> <span style="margin-left:35px">{{fromDate|date}}</span>
        </div>
      </div>
    </div>
    <div class="ui-grid-row">
      <div class="ui-grid-col-3">
        <label for="thruDate">{{'Thru Date'|i18n}}:</label>
      </div>
      <div class="ui-grid-col-4">
        <p-calendar formControlName="thruDate" [showIcon]="true"></p-calendar> <span style="margin-left:35px">{{thruDate|date}}</span>
      </div>
    </div>
    <div class="ui-grid-row">
      <div class="ui-grid-col-3">
        <label for="contractHours">{{'Contract Hours'|i18n}}:</label>
      </div>
      <div class="ui-grid-col-4">
      </div>
    </div>
    <div class="ui-grid-row">
      <div class="ui-grid-col-3">
        <label for="actualHours">{{'Actual hours'|i18n}}:</label>
      </div>
      <div class="ui-grid-col-4">
      </div>
    </div>
    <p-footer>
      <div class="ui-dialog-buttonpane ui-helper-clearfix">
        <button *ngIf="!newTimesheet" type="button" pButton icon="fa-trash" (click)="confirm()" label="{{'Delete'|i18n}}"></button>
        <button type="submit" pButton icon="fa-check" label="{{'Save'|i18n}}" [disabled]="!form.valid"></button>
      </div>
    </p-footer>
  </form>

  <div *ngIf="error" class="alert alert-danger">{{error}}</div>
</p-dialog>
