<div *ngIf="error" class="alert alert-danger">{{error}}</div>


<div class="pos-f-t fixed-top header">
    <nav class="navbar navbar-expand-sm navbar-toggleable-md fixed-top">
        <button class="navbar-toggler navbar-toggler-right" (click)="toggleSidebar()">
            <span class="navbar-toggler-icon"></span>
        </button>

        <a class="navbar-brand" routerLink="/c">
          <img alt="Gzoom Logo" src="assets/images/logo-light.png" >
        </a>
        <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
            <ul class="navbar-nav ml-auto mt-2 mt-md-0">                
                <div class="nav-item dropdown" ngbDropdown placement="bottom-right">
                    <a href="javascript:void(0)" class="nav-link dropdown-toggle" ngbDropdownToggle>
                        <i class="fa fa-user"></i> &nbsp; {{user|fullname}} <b class="caret"></b>
                    </a>
                    <div ngbDropdownMenu>
                        <a class="dropdown-item" href="jvascript:void(0)"><i class="fa fa-fw fa-user"></i> {{'Profile'|i18n}}</a>
                        <a class="dropdown-item" (click)="changeTheme()"><i class="fa fa-fw fa-power-user"></i> {{'Tema'|i18n}}</a>
                        <a class="dropdown-item" (click)="changePasswordDialog()"><i class="fa fa-fw fa-key"></i> {{'Change password'|i18n}}</a>
                        <a class="dropdown-item" (click)="logout()"><i class="fa fa-fw fa-power-off"></i> {{'Logout'|i18n}}</a>
                    </div>
                </div>
            </ul>
        </div>
        <div>
          <app-report-download></app-report-download>
        </div>
    </nav>
</div>


<p-dialog header="{{'Change password'|i18n}}" width="900" [(visible)]="displayChangePassword" [responsive]="true" showEffect="fade" [modal]="true">
    <form [formGroup]="form" novalidate (ngSubmit)="changePassword()">
      <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid" style="margin: 10px 0px" *ngIf="user">        
        <div class="ui-grid-row">
          <div class="ui-grid-col-3">
            <label for="currentPassword">{{'Current Password'|i18n}}*:</label>
          </div>
          <div class="ui-grid-col-4">
            <input pPassword type="password" [(ngModel)]="currentPassword" formControlName="currentPassword"/>       
          </div>
          <div class="ui-grid-col-5">
            <div class="ui-message ui-messages-error ui-corner-all" *ngIf="!form.controls['currentPassword'].valid&amp;&amp;form.controls['currentPassword'].dirty">
              <i class="fa fa-times"></i>
              {{'Current Password is required'|i18n}}
            </div>
          </div>
        </div> 
        <div class="ui-grid-row">
            <div class="ui-grid-col-3">
              <label for="newPassword">{{'New Password'|i18n}}*:</label>
            </div>
            <div class="ui-grid-col-4">
              <input pPassword type="password" [(ngModel)]="newPassword" formControlName="newPassword" />       
            </div>
            <div class="ui-grid-col-5">
              <div class="ui-message ui-messages-error ui-corner-all" *ngIf="!form.controls['newPassword'].valid&amp;&amp;form.controls['newPassword'].dirty">
                <i class="fa fa-times"></i>
                {{'New Password is required'|i18n}}
              </div>
            </div>
          </div> 
        <div class="ui-grid-row">
            <div class="ui-grid-col-3">
              <label for="newPasswordVerify">{{'Verify new Password'|i18n}}*:</label>
            </div>
            <div class="ui-grid-col-4">
              <input pPassword type="password" [(ngModel)]="newPasswordVerify" formControlName="newPasswordVerify" validateEqual="newPassword"/>       
            </div>
            <div class="ui-grid-col-5">
              <div class="ui-message ui-messages-error ui-corner-all" *ngIf="!form.controls['newPasswordVerify'].valid&amp;&amp;form.controls['newPasswordVerify'].dirty">
                <i class="fa fa-times"></i>
                {{'Verify new Password is incorrect'|i18n}}
              </div>
            </div>
          </div>  
    </div>
      <p-footer>
        <div class="ui-dialog-buttonpane ui-helper-clearfix">
          <button type="submit" pButton icon="fa-check" label="{{'Save'|i18n}}" [disabled]="!form.valid"></button>
        </div>
      </p-footer>
    </form>
  
    <div *ngIf="error" class="alert alert-danger">{{error}}</div>
  </p-dialog>
